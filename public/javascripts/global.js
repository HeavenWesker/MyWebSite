/*! MyWebSite - v0.0.0 - 2015-06-01
* Copyright (c) 2015 Heaven Wesker; Licensed  */
function propulateTable(){$.getJSON("/users/userlist",function(a){var b="";userListData=a,$.each(a,function(){b+="<tr>",b+='<td><a href="#" class="linkshowuser" rel="'+this.username+'">'+this.username+"</td>",b+="<td>"+this.email+"</td>",b+='<td><a href="#" class="linkdeleteuser" rel="'+this._id+'">delete</a></td>',b+="</tr>"}),$("#userList table tbody").html(b)})}function errAlert(a){alert("Error"+a)}function showUserInfo(a){a.preventDefault();var b=$(this).attr("rel"),c=userListData.map(function(a){return a.username}).indexOf(b),d=userListData[c];$("#userInfoName").text(d.username),$("#userInfoAge").text(d.age),$("#userInfoGender").text(d.gender),$("#userInfoLocation").text(d.location),$("#updateUser #inputUserId").val(d._id),$("#updateUser #inputUserName").val(d.username),$("#updateUser #inputUserEmail").val(d.email),$("#updateUser #inputUserFullName").val(d.fullname),$("#updateUser #inputUserAge").val(d.age),$("#updateUser #inputUserGender").val(d.gender),$("#updateUser #inputUserLocation").val(d.location)}function addUser(a){a.preventDefault();var b=0;if($("#addUser input").each(function(){""===$(this).val()&&b++}),0===b){var c={username:$("#addUser input#inputUserName").val(),email:$("#addUser input#inputUserEmail").val(),fullname:$("#addUser input#inputUserFullName").val(),age:$("#addUser input#inputUserAge").val(),gender:$("#addUser input#inputUserGender").val(),location:$("#addUser input#inputUserLocation").val()};$.ajax({method:"POST",data:c,url:"/users/adduser",dataType:"JSON"}).done(function(a){void 0===a.err?($("#addUser input").val(""),propulateTable()):alert("Error: "+a.err)})}else alert("Error, please input all information")}function deleteUser(a){a.preventDefault(),$.ajax({method:"DELETE",url:"/users/deleteuser/"+$(this).attr("rel")}).done(function(a){null!==a.err&&0!==a.msg.n?propulateTable():errAlert(a.err)})}function updateUser(a){a.preventDefault(),""!==$("#updateUser input#inputUserId").val()&&$.ajax({method:"PUT",url:"/users/updateuser/"+$("#updateUser #inputUserId").val(),data:{username:$("#updateUser #inputUserName").val(),email:$("#updateUser #inputUserEmail").val(),fullname:$("#updateUser #inputUserFullName").val(),age:$("#updateUser #inputUserAge").val(),gender:$("#updateUser #inputUserGender").val(),location:$("#updateUser #inputUserLocation").val()}}).done(function(a){""===a.msg?propulateTable():alert("Error: update not successed")})}var userListData=[];$(document).ready(function(){propulateTable(),$("#userList table tbody").on("click","td a.linkshowuser",showUserInfo),$("#btnAddUser").on("click",addUser),$("#userList table tbody").on("click","td a.linkdeleteuser",deleteUser),$("#btnUpdateUser").on("click",updateUser)});